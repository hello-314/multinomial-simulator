
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‹¤í•­ë¶„í¬ ì‹œë®¬ë ˆì´í„°</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input { margin: 5px; padding: 5px; }
    button { margin: 10px; padding: 8px; }
    .prob-inputs { margin: 10px 0; }
    .section { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 10px; }
  </style>
</head>
<body>
  <h2>ğŸ² ë‘ ì‹¤í—˜ ë‹¤í•­ë¶„í¬ ì‹œë®¬ë ˆì´í„° (ì—¬ëŸ¬ ê´€ì‹¬ ê°’ ì¶”ì )</h2>

  <div class="section">
    <h3>ì‹¤í—˜ 1 ì„¤ì •</h3>
    <label>ê²°ê³¼ ì¢…ë¥˜ ìˆ˜: <input type="number" id="categoryCount1" value="3" min="2" max="10"></label>
    <button onclick="generateProbInputs(1)">í™•ë¥  ì…ë ¥ì°½ ìƒì„±</button>
    <div class="prob-inputs" id="probInputs1"></div>
    <label>ì‹œí–‰ íšŸìˆ˜: <input type="number" id="trials1" value="10"></label><br>
    <label>ë°˜ë³µ íšŸìˆ˜: <input type="number" id="repeats1" value="500"></label><br>
    <label>ê´€ì‹¬ ê°’ë“¤ (ì‰¼í‘œë¡œ êµ¬ë¶„): <input type="text" id="targetValues1" value="1"></label><br>
  </div>

  <div class="section">
    <h3>ì‹¤í—˜ 2 ì„¤ì •</h3>
    <label>ê²°ê³¼ ì¢…ë¥˜ ìˆ˜: <input type="number" id="categoryCount2" value="3" min="2" max="10"></label>
    <button onclick="generateProbInputs(2)">í™•ë¥  ì…ë ¥ì°½ ìƒì„±</button>
    <div class="prob-inputs" id="probInputs2"></div>
    <label>ì‹œí–‰ íšŸìˆ˜: <input type="number" id="trials2" value="10"></label><br>
    <label>ë°˜ë³µ íšŸìˆ˜: <input type="number" id="repeats2" value="500"></label><br>
    <label>ê´€ì‹¬ ê°’ë“¤ (ì‰¼í‘œë¡œ êµ¬ë¶„): <input type="text" id="targetValues2" value="1"></label><br>
  </div>

  <button onclick="runComparisonSimulation()">ğŸ¯ ë‘ ì‹¤í—˜ ë¹„êµ ì‹¤í–‰</button>

  <h3>ğŸ“Š ê²°ê³¼</h3>
  <pre id="result"></pre>
  <canvas id="chart" width="800" height="400"></canvas>

  <script>
    function generateProbInputs(id) {
      const count = parseInt(document.getElementById(`categoryCount${id}`).value);
      const container = document.getElementById(`probInputs${id}`);
      container.innerHTML = '';
      for (let i = 0; i < count; i++) {
        container.innerHTML += `ì¢…ë¥˜ ${i + 1} í™•ë¥ : <input type="number" step="0.01" id="prob${id}_${i}" value="${(1/count).toFixed(2)}"><br>`;
      }
    }

    function runSimulation(categoryCount, trials, repeats, targetValues, probPrefix) {
      let probs = [];
      for (let i = 0; i < categoryCount; i++) {
        probs.push(parseFloat(document.getElementById(`${probPrefix}_${i}`).value));
      }
      const totalProb = probs.reduce((a, b) => a + b, 0);
      if (Math.abs(totalProb - 1) > 0.001) {
        alert(`${probPrefix} í™•ë¥ ì˜ í•©ì€ 1ì´ì–´ì•¼ í•©ë‹ˆë‹¤.`);
        return null;
      }

      let targets = targetValues.split(',').map(v => parseInt(v.trim()) - 1);
      const freq = Array(trials + 1).fill(0);

      for (let i = 0; i < repeats; i++) {
        let countTarget = 0;
        for (let j = 0; j < trials; j++) {
          let r = Math.random();
          let cumulative = 0;
          for (let k = 0; k < categoryCount; k++) {
            cumulative += probs[k];
            if (r < cumulative) {
              if (targets.includes(k)) countTarget++;
              break;
            }
          }
        }
        freq[countTarget]++;
      }
      return freq;
    }

    function runComparisonSimulation() {
      const count1 = parseInt(document.getElementById("categoryCount1").value);
      const n1 = parseInt(document.getElementById("trials1").value);
      const r1 = parseInt(document.getElementById("repeats1").value);
      const targets1 = document.getElementById("targetValues1").value;

      const count2 = parseInt(document.getElementById("categoryCount2").value);
      const n2 = parseInt(document.getElementById("trials2").value);
      const r2 = parseInt(document.getElementById("repeats2").value);
      const targets2 = document.getElementById("targetValues2").value;

      const freq1 = runSimulation(count1, n1, r1, targets1, "prob1");
      const freq2 = runSimulation(count2, n2, r2, targets2, "prob2");

      if (!freq1 || !freq2) return;

      const labels = Array(Math.max(freq1.length, freq2.length)).fill(0).map((_, i) => `${i}ë²ˆ`);
      const ctx = document.getElementById('chart').getContext('2d');
      if (window.myChart) window.myChart.destroy();

      document.getElementById("result").textContent = `ì‹¤í—˜ 1ê³¼ ì‹¤í—˜ 2ì˜ ê²°ê³¼ë¥¼ ë¹„êµí•œ ê·¸ë˜í”„ì…ë‹ˆë‹¤.`;

      window.myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [
            {
              label: 'ì‹¤í—˜ 1',
              data: freq1,
              backgroundColor: 'rgba(54, 162, 235, 0.6)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1
            },
            {
              label: 'ì‹¤í—˜ 2',
              data: freq2,
              backgroundColor: 'rgba(255, 159, 64, 0.6)',
              borderColor: 'rgba(255, 159, 64, 1)',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          scales: {
            x: { stacked: false, title: { display: true, text: 'ê´€ì‹¬ ê°’ ë“±ì¥ íšŸìˆ˜' } },
            y: { beginAtZero: true, title: { display: true, text: 'ë¹ˆë„' } }
          }
        }
      });
    }

    window.onload = function() {
      generateProbInputs(1);
      generateProbInputs(2);
    };
  </script>
</body>
</html>
